||||
|:--|:--|:--
|[Module Readme](../README.md)|[Module User Guide](../)|[Get Support](https://confluence.axa.com/confluence/x/L49iDw)|
##
## <font color="red"><b>Defining your Virtual Machine</b></font>

---
> NOTE: Check the permissions required https://confluence.axa.com/confluence/x/cpfFDg
> NOTE: Virtual Machine name is made from many fields (global-env is development in this case)
### Preconditions
> NOTE: Configuration adheres to some prerequisites you will be blocked if you try to deploy a Virtual machine under the following
- Must use reserve_capacity for Production and DR Gold.
- Must use a valid role for OS.
- Must specify a valid image for OS.
- Must enable encryption on secret virtual machines.
####
| SET1 	| **SET2**        	| **SET3**           	| **SET3** OPTIONAL      	| **SET4**       	| **SET5**              	| **SET7**         	|
|:------	|:-------------	|:----------------	|:------------	|:------------	|:-------------------	|:--------------	|
| CSP  	| global-opco 	| short_app_name 	| vm_name 	| global-env 	| environment_index 	| object_index 	|
| `z`    	| `ago`         	| `demo`           	| `myname`           	| `dv`         	| `01`                	| `001`          	|
### Variables
| Variable                    	| Description                                                                                                                                                                                         	| Mandatory 	| Validation                      	| Example                 	|
|:-----------------------------	|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	|:-----------	|:---------------------------------	|:-------------------------	|
| support_resource_group 	| Resource group where the support components are  	| Yes     	| NA 	| z-ago-myname-dv01-en1-01 	|
| resource_group_app_name     	| **SET3**: Used for resource group application code so its not the same as VMs                                                                                                                         	| No     	| 3-7 (chars)                       	| `myapp`                 	|
| short_app_name              	| **SET3**: Used for naming of resources and identification of the resource group                                                                                                                       	| Yes      	| 2-20 (chars)                       	| `demo`                    	|
| vm_name              	| **SET3**: Used for naming of resources and identification of the resource group                                                                                                                       	| No      	| 0-20 (chars)                       	| `myname`                    	|
| environment_index           	| **SET4**: Environment index as part of the naming convention defaults to 01 this is to allow deployment of multiple environments this is not the same as network_environment_index which is for spokes.                                                                                                                           	| No     	| 01-99                           	| `01`                      	|
| location               	| **SET6**: Validated to be a valid location used to match a 3 characters following AXA convention e.g. en1 for north europe not used to name the machine due to cross region DR would make no sense.                                                                                                            	northeurope | No      	| `northeurope` `westeurope` `eastus2` `eastasia` `switzerlandnorth`                       	| `northeurope`                     	|
resource_group_object_index 	| **SET7**: Resource group unique object Index in the format of (01-99) default to 01                                                                                                                   	| No     	| 01-99                          	| `10`                      	|
| object_index                	| **SET7**: Validated to be 3 digits used to ensure a unique VM name and should align your to your module header e.g. windows_virualmachine_001                                                         	| Yes      	| 001-999                         	| `001`                     	|
| os_type                     	| Determines the type of VM to build                                                                                                                                                                  	| Yes      	| `windows` `linux`                  	| `windows`                 	|
| vm_size                     	| Used to determine the VM size to build this is defaults to Standard_DS2_v2 refer to Azure compute unit (ACU) limited to the following families.                                                                                       	| No     	| `Standard_D*` `Standard_E*` `Standard_F*`                                	| `Standard_DS2_v2`         	|
| axavmrole                   	| Role of the VM this is used by Puppet defaults to base                                                                                                                                              	| No     	| `base` `sql` `oracle` `db2`               	| `base`                    	|
| enable_shutdown             	| Shutdown or not                                                                                                                                                                                     	| No     	| `true` `false`                     	| `false`                    	|
| daily_shutdown_time         	| The regional time each day when the schedule takes effect. Must match the format HHmm where HH is 00-23 and mm is 00-59                                                                                      	| Yes      	| HHmm                            	| `2000`                    	|
| availability_zones           	| Used to set the zone the VM is deployed defaulted to 0 (not used) the second digut is only used for DR Gold.                                                                                                                                   	| No     	| `"1,2"` `"2,1"` `"1,3"` `"3,1"` `"3,2"` `"2,3"`| `"1,2"`                      	|
| dr_serviceclass                 	| Used to update Silva with the DR service class and apply DR, Bronze makes disks zonal only, Gold configures DR                                                                                                                                                                                        	| No     	| `none` `bronze` `gold` ~~platinum~~  	| `none`                	|
| reserve_capacity 	|  Use on-demand capacity reservations must have reserved using support module	| No     	| `true`, `false` 	| `false` 	|
| image_template              	| Must be an image template with a valid version in the management subscription current templates for Linux must be BYOS image.                                                                                                    	| Yes      	|      `Windows_2019_Mutable` `Windows_2016_Mutable` `RHEL86_BYOS_Mutable` `RHEL79_BYOS_Mutable`                           	| `Windows_2019_Mutable`                        	|
| orchestration_dry_run              	| Used to test a deployment doesnt deploy a Virtual Machine but does call the orchestration platform templates                                                                                                     	| No      	|      `false` `true`                      	| `false`                        	|
| orchestration_re_run              	| Used to resume orchestration on a Virtual Machine                                                                                                      	| No      	|      `false` `true`                      	| `false`                        	|
| notification_email              	| Used to tell orchestration to send a email to distriution group specified                                                                                                      	| No      	|      email address less than 255                       	| `user@host.com`                        	|
| global_monitoring              	| Used to send global logs defaults to true                                                                                                       	| No      	|      `false` `true`                      	| `true`                        	|
| image_version               	| Must be an image version in the management subscription for image_template this defaults to latest                                                                                                  	| No     	| `latest`                                	| 0.24936.7112            	|
| gallery_environment_index   	| **SET4**: Gallery environment Index to cater for possibility of other galleries  (01-99)                                                                                                                      	| No     	| 01-99                           	| `01`                      	|
| gallery_object_index        	| **SET7**: Gallery Index in the format of (01-99).                                                                                                                                                     	| No     	| 01-99                           	| `01` |
